{"ast":null,"code":"import axios from \"axios\";\nimport jwt from 'jwt-decode';\nconst API_URL = \"http://localhost:8080\";\nexport const login = (username, password) => {\n  return axios.post(API_URL + \"/authenticate\", {\n    username,\n    password\n  }).then(response => {\n    if (response.data.token) {\n      console.log(JSON.stringify(jwt(response.data.token)));\n      localStorage.setItem(\"user\", JSON.stringify(jwt(response.data.token)));\n      localStorage.setItem(\"token\", JSON.stringify(response.data.token));\n    }\n\n    return JSON.parse(localStorage.getItem('user'));\n  });\n};\nexport const logout = () => {\n  localStorage.removeItem(\"user\");\n};\nexport const register = (username, password, nombre, apellido, email) => {\n  return axios.post(API_URL + \"/register\", {\n    username,\n    mail: email,\n    password,\n    name: nombre,\n    apellido\n  });\n};\nexport const getUsers = () => {\n  const user = JSON.parse(localStorage.getItem('user'));\n  return axios.get(API_URL + `/users/${user.sub}`, {\n    headers: authHeader()\n  });\n};\nexport const makeAdmin = username => {\n  console.log(authHeader());\n  return axios.post(API_URL + `/make_admin/${username}`, {\n    headers: authHeader()\n  });\n};\nexport const updateUser = (nombre, apellido, email) => {\n  const user = JSON.parse(localStorage.getItem('user'));\n  return axios.post(API_URL + `/user/${user.sub}`, {\n    mail: email,\n    name: nombre,\n    apellido\n  }, {\n    headers: authHeader()\n  });\n};\nexport const updateUserPassword = (oldPassword, newPassword) => {\n  const user = JSON.parse(localStorage.getItem('user'));\n  return axios.post(API_URL + `/changePass`, {\n    username: user.sub,\n    oldPassword,\n    newPassword\n  }, {\n    headers: authHeader()\n  }).then(response => {\n    if (response.data.token) {\n      localStorage.setItem(\"token\", JSON.stringify(response.data.token));\n    }\n\n    return response;\n  });\n};\nexport const getUser = () => {\n  const user = JSON.parse(localStorage.getItem('user'));\n  return axios.get(API_URL + `/user/${user.sub}`, {\n    headers: authHeader()\n  });\n};\nexport const authHeader = () => {\n  const token = JSON.parse(localStorage.getItem('token'));\n  console.log(token);\n\n  if (token) {\n    return {\n      Authorization: token\n    };\n  } else {\n    return {};\n  }\n};","map":{"version":3,"sources":["/Users/nicolaspavon/Desktop/ReposFacu/seguridadFE/src/Utils/api.js"],"names":["axios","jwt","API_URL","login","username","password","post","then","response","data","token","console","log","JSON","stringify","localStorage","setItem","parse","getItem","logout","removeItem","register","nombre","apellido","email","mail","name","getUsers","user","get","sub","headers","authHeader","makeAdmin","updateUser","updateUserPassword","oldPassword","newPassword","getUser","Authorization"],"mappings":"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","sourcesContent":["import axios from \"axios\";\nimport jwt from 'jwt-decode'\n\nconst API_URL = \"http://localhost:8080\";\n\nexport const login = (username, password) => {\n\treturn axios.post(API_URL + \"/authenticate\", { username, password })\n\t\t.then((response) => {\n\t\t\tif (response.data.token) {\n\t\t\t\tconsole.log(JSON.stringify(jwt(response.data.token)));\n\t\t\t\tlocalStorage.setItem(\"user\", JSON.stringify(jwt(response.data.token)));\n\t\t\t\tlocalStorage.setItem(\"token\", JSON.stringify(response.data.token));\n\t\t\t}\n\t\t\treturn JSON.parse(localStorage.getItem('user'));\n\t\t});\n}\n\nexport const logout = () => {\n\tlocalStorage.removeItem(\"user\");\n}\n\nexport const register = (username, password, nombre, apellido, email) => {\n\treturn axios.post(API_URL + \"/register\", {\n\t\tusername,\n\t\tmail: email,\n\t\tpassword,\n\t\tname: nombre,\n\t\tapellido,\n\t});\n}\n\nexport const getUsers = () => {\n\tconst user = JSON.parse(localStorage.getItem('user'));\n\treturn axios.get(API_URL + `/users/${user.sub}`, { headers: authHeader() });\n}\n\nexport const makeAdmin = (username) => {\n\tconsole.log(authHeader());\n\treturn axios.post(API_URL + `/make_admin/${username}`, { headers: authHeader() }); \n}\n\nexport const updateUser = (nombre, apellido, email) => {\n\tconst user = JSON.parse(localStorage.getItem('user'));\n\treturn axios.post(API_URL + `/user/${user.sub}`, {\n\t\tmail: email,\n\t\tname: nombre,\n\t\tapellido, \n\t},{\n\t\theaders: authHeader() \n\t}); \n}\n\nexport const updateUserPassword = (oldPassword, newPassword) => {\n\tconst user = JSON.parse(localStorage.getItem('user'));\n\treturn axios.post(API_URL + `/changePass`, {\n\t\tusername: user.sub,\n\t\toldPassword,\n\t\tnewPassword,\n\t},\n\t{ headers: authHeader() }).then((response) => {\n\t\tif (response.data.token) {\n\t\t\tlocalStorage.setItem(\"token\", JSON.stringify(response.data.token));\n\t\t}\n\t\treturn response;\n\t}); \n}\n\nexport const getUser = () => {\n\tconst user = JSON.parse(localStorage.getItem('user'));\n\treturn axios.get(API_URL + `/user/${user.sub}`, { headers: authHeader() }); \n}\n\nexport const authHeader = () => {\n  const token = JSON.parse(localStorage.getItem('token'));\n  console.log(token);\n  if (token) {\n    return { Authorization: token };\n  } else {\n    return {};\n  }\n}"]},"metadata":{},"sourceType":"module"}